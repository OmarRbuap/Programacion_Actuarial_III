}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$prueba2.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(Result, length(state), 2, byrow = TRUE)
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal
}
head(rankingcompleto("ataque", 20), 10)
resultado <- "ataque"
num <-20
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
est <- 1
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$prueba2.Hospital.Name[num]
}
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
Result
rankingcompleto <- function(resultado,num){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(Result, length(state), 2, byrow = TRUE)
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal
}
head(rankingcompleto("ataque", 20), 10)
rankingcompleto <- function(resultado,num){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal
}
head(rankingcompleto("ataque", 20), 10)
rankingcompleto <- function(resultado,num){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3)){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal <- ResultFinal[order(ResultFinal$Estado),]
ResultFinal
}
head(rankingcompleto("ataque", 20), 10)
tail(rankingcompleto("neumonÃ­a", "peor"), 3)
tail(rankingcompleto("neumonia", "peor"), 3)
tail(rankingcompleto("falla"), 10)
rankingcompleto <- function(resultado,num){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if(num <= nrow(prueba3))|(num == ""){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal <- ResultFinal[order(ResultFinal$Estado),]
ResultFinal
}
rankingcompleto <- function(resultado,num){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if((num <= nrow(prueba3)) | (num == "")){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal <- ResultFinal[order(ResultFinal$Estado),]
ResultFinal
}
tail(rankingcompleto("falla"), 10)
rankingcompleto <- function(resultado,num="mejor"){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if((num <= nrow(prueba3)) | (num == "")){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal <- ResultFinal[order(ResultFinal$Estado),]
ResultFinal
}
tail(rankingcompleto("falla"), 10)
mejor <- function(estado,resultado){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
state <- as.character(outcome$State)
if(!(estado %in% state)){
stop("Resultado invalido probar nuevamente")
break
}
## Regresa el nombre del hospital con la tasa mÃ¡s baja de mortalidad de 30 dÃ­as
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
causa <- suppressWarnings(as.numeric(causa))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- as.data.frame.numeric(tabla)
prueba1 <- subset(tabla,outcome$State==estado)
prueba2 <- prueba1[order(prueba1$causa),]
hospital <- as.character(prueba2$outcome.Hospital.Name[1])
print(hospital)
}
mejor("TX", "ataque")
mejor("TX", "falla")
mejor("MD", "ataque")
mejor("MD", "neumonia")
mejor("BB", "ataque")
mejor("NY", "atakue")
mejor <- function(estado,resultado){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Error en padecimiento, probar nuevamente")
break
}
state <- as.character(outcome$State)
if(!(estado %in% state)){
stop("Error en el estado, probar nuevamente")
break
}
## Regresa el nombre del hospital con la tasa mÃ¡s baja de mortalidad de 30 dÃ­as
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
causa <- suppressWarnings(as.numeric(causa))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- as.data.frame.numeric(tabla)
prueba1 <- subset(tabla,outcome$State==estado)
prueba2 <- prueba1[order(prueba1$causa),]
hospital <- as.character(prueba2$outcome.Hospital.Name[1])
print(hospital)
}
mejor("TX", "ataque")
mejor("TX", "falla")
mejor("MD", "ataque")
mejor("MD", "neumonia")
mejor("BB", "ataque")
mejor("NY", "atakue")
rankhospital <- function(estado,resultado,rank){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
state <- as.character(outcome$State)
if(!(estado %in% state)){
stop("Resultado invalido probar nuevamente")
break
}
## Regresa el nombre del hospital con la tasa mÃ¡s baja de mortalidad de 30 dÃ­as
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
prueba1 <- subset(tabla1,tabla1$outcome.State == estado)
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- data.frame(prueba2$outcome.Hospital.Name,prueba2$causa)
u <- sum(is.na(prueba2$causa))
t <- length(prueba2$causa)-u
TablaTotal <- prueba3[1:t,]
ranki <- (1:t)
Rank <- as.data.frame(ranki)
RankTotal <-cbind(TablaTotal,Rank)
names(RankTotal) <- c("Nombre.de.Hospital","Tasa","Rank")
if(rank == "mejor"){
Nhospital <- as.character(RankTotal$Nombre.de.Hospital[1])
}else if(rank == "peor"){
Nhospital <- as.character(RankTotal$Nombre.de.Hospital[t])
}else if(rank %in% ranki){
Nhospital <- as.character(RankTotal$Nombre.de.Hospital[rank])
}else if(rank > t){
Nhospital <- NA
}else{
stop("Resultado invalido probar nuevamente")
break
}
print(Nhospital)
}
rankhospital("TX","falla",4)
rankhospital("MD","ataque","peor")
rankhospital("MN","falla",5000)
rankingcompleto <- function(resultado,num="mejor"){
#lectura de datos
setwd("C:/Users/omar/Desktop/Programacion_Actuarial_III/Caso 2/Calidad de Hospitales - data")
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
if(!((resultado =="ataque") | (resultado =="falla") | (resultado =="neumonia"))){
stop ("Resultado invalido probar nuevamente")
break
}
if(resultado=="ataque"){
causa <- outcome[,11]
} else if(resultado=="falla"){
causa <- outcome[,17]
} else if(resultado=="neumonia"){
causa <- outcome[,23]
}
Result <- c()
state <- unique(as.character(outcome$State))
causa <- suppressWarnings(as.numeric(causa))
Hospital <- suppressWarnings(as.character(outcome$Hospital.Name))
tabla <- data.frame(outcome$Hospital.Name,outcome$State,causa)
tabla1 <- tabla[order(tabla$outcome.Hospital.Name),]
tabla2 <- tabla1[order(tabla1$outcome.State),]
for(est in 1:length(state)){
prueba1 <- subset(tabla2,tabla2$outcome.State == state[est])
prueba2 <- prueba1[order(prueba1$causa),]
prueba3 <- prueba2[complete.cases(prueba2),]
if(num == "mejor"){
hs <- prueba3$outcome.Hospital.Name[1]
}else if(num =="peor"){
hs <- prueba3$outcome.Hospital.Name[nrow(prueba3)]
}else if(num > nrow(prueba3)){
hs <- "<NA>"
}else if((num <= nrow(prueba3)) | (num == "")){
hs <- prueba3$outcome.Hospital.Name[num]
}
hs <- as.character(hs)
Result <- append(Result, c(hs,state[est]))
}
ResultFinal <- as.data.frame(matrix(Result, length(state), 2, byrow = TRUE))
colnames(ResultFinal) <- c("Hospital", "Estado")
rownames(ResultFinal) <- state
ResultFinal <- ResultFinal[order(ResultFinal$Estado),]
ResultFinal
}
head(rankingcompleto("ataque", 20), 10)
tail(rankingcompleto("neumonia", "peor"), 3)
tail(rankingcompleto("falla"), 10)
